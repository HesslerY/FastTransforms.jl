var documenterSearchIndex = {"docs":
[{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"EditURL = \"https://github.com/JuliaApproximation/FastTransforms.jl/blob/master/examples/disk.jl\"","category":"page"},{"location":"generated/disk/#Holomorphic-integration-on-the-unit-disk-1","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"","category":"section"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"In this example, we explore integration of a harmonic function:","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"  f(xy) = fracx^2-y^2+1(x^2-y^2+1)^2+(2xy+1)^2","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"over the unit disk. In this case, we know from complex analysis that the integral of a holomorphic function is equal to pi times f(00). We analyze the function on an Ntimes M tensor product grid defined by:","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"beginaligned\nr_n  = cosleft(n+tfrac12)pi2Nrightquadrm forquad 0le n  Nquadrm and\ntheta_m  = 2pi mMquadrm forquad 0le m  M\nendaligned","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"we convert the function samples to Chebyshev×Fourier coefficients using plan_disk_analysis; and finally, we transform the Chebyshev×Fourier coefficients to Zernike polynomial coefficients using plan_disk2cxf.","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"For the storage pattern of the arrays, please consult the documentation.","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"using FastTransforms, LinearAlgebra","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"Our function f on the disk:","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"f = (x,y) -> (x^2-y^2+1)/((x^2-y^2+1)^2+(2x*y+1)^2)","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"#1 (generic function with 1 method)","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"The Zernike polynomial degree:","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"N = 5\nM = 4N-3","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"17","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"The radial grid:","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"r = [sinpi((N-n-0.5)/(2N)) for n in 0:N-1]","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"5-element Array{Float64,1}:\n 0.9876883405951378\n 0.8910065241883678\n 0.7071067811865476\n 0.45399049973954675\n 0.15643446504023087","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"The angular grid (mod pi):","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"θ = (0:M-1)*2/M","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"0.0:0.11764705882352941:1.8823529411764706","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"On the mapped tensor product grid, our function samples are:","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"F = [f(r*cospi(θ), r*sinpi(θ)) for r in r, θ in θ]","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"5×17 Array{Float64,2}:\n 0.402946  0.301497  0.214805  0.123652  0.029506  0.641953  1.35459   0.691551  0.469645  0.348746  0.2577    0.170699  0.0735319  0.0608339  1.88262   0.91679   0.558908\n 0.425289  0.325587  0.246284  0.177376  0.161338  0.731296  1.17076   0.706363  0.491987  0.371506  0.284466  0.210249  0.153589   0.282381   1.28362   0.89755   0.580363\n 0.461538  0.373905  0.313401  0.285715  0.350511  0.65826   0.850822  0.679155  0.519715  0.413757  0.340547  0.293778  0.298457   0.469421   0.82261   0.776909  0.591499\n 0.491347  0.439008  0.409084  0.412522  0.465493  0.55916   0.615445  0.587905  0.523361  0.462848  0.420724  0.405647  0.432037   0.510651   0.597765  0.610169  0.556835\n 0.499854  0.49189   0.48799   0.490136  0.497555  0.506509  0.511978  0.51092   0.50421   0.495572  0.489253  0.488282  0.493358   0.50216    0.509953  0.512302  0.508078","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"We precompute a Zernike–Chebyshev×Fourier plan:","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"P = plan_disk2cxf(F)","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"FastTransforms Zernike--Chebyshev×Fourier plan for 5×17-element array of Float64","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"And an FFTW Chebyshev×Fourier analysis plan on the disk:","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"PA = plan_disk_analysis(F)","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"FastTransforms plan for FFTW Chebyshev×Fourier analysis on the disk for 5×17-element array of Float64","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"Its Zernike coefficients are:","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"U = P\\(PA*F)","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"5×17 Array{Float64,2}:\n  0.886227    -0.0111632   0.00585279   -0.361937     0.000137729  0.00317103   -0.0196974    0.140124    -0.140638     0.0202154    0.0235831   0.000691523  0.119117     -0.0483587    -0.00171024   -0.0538662    -0.0522193\n -4.02088e-7  -0.0115134   0.00593145   -0.000140273  0.000141258  0.00249442   -0.0131575   -8.82847e-7  -0.000424915  0.00781904   0.0100188   0.000466725  0.000465122  -0.0079837    -0.000842787  -0.000800707   1.3039e-6\n -4.38231e-7  -0.00837677  0.00417771   -0.000117736  0.000118647  0.00152713   -0.00643496  -6.34956e-7  -0.000275705  0.00166067   0.00254081  0.000194796  0.000194048  -0.00240669   -0.000450534  -0.000407336   7.27013e-7\n -4.1237e-7   -0.00450182  0.00214949   -6.71693e-5   6.77235e-5   0.000414072  -0.00143016  -1.78277e-7  -7.32756e-5   0.000704026  0.00114584  8.42513e-5   8.39216e-5   -0.000975294  -0.000228448  -0.000175416   3.20375e-7\n -2.1831e-7   -0.00129467  0.000596595  -4.59252e-6   4.63176e-6   0.00038745   -0.00132803  -3.34039e-8  -1.37124e-5   0.000646309  0.00106037  1.57628e-5   1.5701e-5    -0.000890071  -0.000214341  -3.28076e-5    6.0028e-8","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"The Zernike coefficients are useful for integration. The integral of f(xy) over the disk should be pi2 by harmonicity. The coefficient of Z_0^0 multiplied by √π is:","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"U[1, 1]*sqrt(π)","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"1.5707958936825126","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"Using an orthonormal basis, the integral of f(xy)^2 over the disk is approximately the square of the 2-norm of the coefficients:","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"norm(U)^2","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"0.980248663883676","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"","category":"page"},{"location":"generated/disk/#","page":"Holomorphic integration on the unit disk","title":"Holomorphic integration on the unit disk","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"EditURL = \"https://github.com/JuliaApproximation/FastTransforms.jl/blob/master/examples/sphere.jl\"","category":"page"},{"location":"generated/sphere/#Spherical-harmonic-addition-theorem-1","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"","category":"section"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"This example confirms numerically that","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"f(z) = fracP_4(zcdot y) - P_4(xcdot y)zcdot y - xcdot y","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"is actually a degree-3 polynomial on mathbbS^2, where P_4 is the degree-4 Legendre polynomial, and xyz in mathbbS^2. To verify, we sample the function on a 5times9 equiangular grid defined by:","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"beginaligned\ntheta_n  = (n+tfrac12)piNquadrm forquad 0le n  Nquadrm and\nvarphi_m  = 2pi mMquadrm forquad 0le m  M\nendaligned","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"we convert the function samples to Fourier coefficients using plan_sph_analysis; and finally, we transform the Fourier coefficients to spherical harmonic coefficients using plan_sph2fourier.","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"In the basis of spherical harmonics, it is plain to see the addition theorem in action, since P_4(xcdot y) should only consist of exact-degree-4 harmonics.","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"For the storage pattern of the arrays, please consult the documentation.","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"function threshold!(A::AbstractArray, ϵ)\n    for i in eachindex(A)\n        if abs(A[i]) < ϵ A[i] = 0 end\n    end\n    A\nend\n\nusing FastTransforms, LinearAlgebra","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"The colatitudinal grid (mod pi):","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"N = 5\nθ = (0.5:N-0.5)/N","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"0.1:0.2:0.9","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"The longitudinal grid (mod pi):","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"M = 2*N-1\nφ = (0:M-1)*2/M","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"0.0:0.2222222222222222:1.7777777777777777","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"Arbitrarily, we place x at the North pole:","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"x = [0,0,1]","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"3-element Array{Int64,1}:\n 0\n 0\n 1","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"Another vector is completely free:","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"y = normalize([.123,.456,.789])","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"3-element Array{Float64,1}:\n 0.13375998748853216\n 0.4958906853233388\n 0.8580213831581455","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"Thus z in mathbbS^2 is our variable vector, parameterized in spherical coordinates:","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"z = (θ,φ) -> [sinpi(θ)*cospi(φ), sinpi(θ)*sinpi(φ), cospi(θ)]","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"#1 (generic function with 1 method)","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"The degree-4 Legendre polynomial is:","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"P4 = x -> (35*x^4-30*x^2+3)/8","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"#3 (generic function with 1 method)","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"On the tensor product grid, our function samples are:","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"F = [(P4(z(θ,φ)⋅y) - P4(x⋅y))/(z(θ,φ)⋅y - x⋅y) for θ in θ, φ in φ]","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"5×9 Array{Float64,2}:\n  4.60889    6.11215    6.63658    5.78535     4.18847    2.80006     2.11673    2.21633     3.09631\n  1.63591    4.42049    5.61202    3.73278     1.04275   -0.248156   -0.463973  -0.451025   -0.0647722\n -0.44714    0.316116   0.843534   0.0561656  -0.469624  -0.0830683   0.198439   0.163989   -0.208218\n  0.072684  -0.286176  -0.378663  -0.216321    0.168303   0.216675   -0.146482  -0.0647457   0.266239\n  0.174701   0.263215   0.273061   0.252482    0.127136  -0.151328   -0.398994  -0.356172   -0.0715676","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"We precompute a spherical harmonic–Fourier plan:","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"P = plan_sph2fourier(F)","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"FastTransforms Spherical harmonic--Fourier plan for 5×9-element array of Float64","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"And an FFTW Fourier analysis plan on mathbbS^2:","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"PA = plan_sph_analysis(F)","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"FastTransforms plan for FFTW Fourier analysis on the sphere for 5×9-element array of Float64","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"Its spherical harmonic coefficients demonstrate that it is degree-3:","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"V = PA*F\nU3 = threshold!(P\\V, 400*eps())","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"5×9 Array{Float64,2}:\n 2.8263    2.12714  0.573768  0.455803  -0.783431  -0.176704  -0.17848  0.0  0.0\n 3.68051   2.92381  0.78866   0.516833  -0.888327   0.0        0.0      0.0  0.0\n 2.3975    1.90894  0.514912  0.0        0.0        0.0        0.0      0.0  0.0\n 0.685033  0.0      0.0       0.0        0.0        0.0        0.0      0.0  0.0\n 0.0       0.0      0.0       0.0        0.0        0.0        0.0      0.0  0.0","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"Similarly, on the tensor product grid, the Legendre polynomial P_4(zcdot y) is:","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"F = [P4(z(θ,φ)⋅y) for θ in θ, φ in φ]","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"5×9 Array{Float64,2}:\n -0.0175839   0.524363    0.755924   0.390706   -0.133598  -0.387638   -0.428086  -0.426174   -0.351513\n -0.416115   -0.0716357   0.323254  -0.239853   -0.346307   0.132515    0.335867   0.314703    0.019703\n  0.309306   -0.15262    -0.306772  -0.0423671   0.367785   0.0812643  -0.283297  -0.231523    0.20915\n -0.105696    0.277812    0.344612   0.216713   -0.237849  -0.361492    0.243839   0.0980303  -0.423838\n -0.299777   -0.420914   -0.42849   -0.408918   -0.225647   0.252599    0.714592   0.632903    0.110051","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"Its spherical harmonic coefficients demonstrate that it is exact-degree-4:","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"V = PA*F\nU4 = threshold!(P\\V, 3*eps())","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"5×9 Array{Float64,2}:\n  0.0        0.0       0.0       0.0        0.0        0.0        0.0       -0.0528646  0.0300531\n  0.0        0.0       0.0       0.0        0.0       -0.202154  -0.204187   0.0        0.0\n  0.0        0.0       0.0       0.363961  -0.625573   0.0        0.0        0.0        0.0\n  0.0        0.855921  0.230873  0.0        0.0        0.0        0.0        0.0        0.0\n -0.0171809  0.0       0.0       0.0        0.0        0.0        0.0        0.0        0.0","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"The L^2(mathbbS^2) norm of the function is:","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"nrm1 = norm(U4)","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"1.1816359006036774","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"Finally, the Legendre polynomial P_4(zcdot x) is aligned with the grid:","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"F = [P4(z(θ,φ)⋅x) for θ in θ, φ in φ]","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"5×9 Array{Float64,2}:\n  0.562436   0.562436   0.562436   0.562436   0.562436   0.562436   0.562436   0.562436   0.562436\n -0.398374  -0.398374  -0.398374  -0.398374  -0.398374  -0.398374  -0.398374  -0.398374  -0.398374\n  0.375      0.375      0.375      0.375      0.375      0.375      0.375      0.375      0.375\n -0.398374  -0.398374  -0.398374  -0.398374  -0.398374  -0.398374  -0.398374  -0.398374  -0.398374\n  0.562436   0.562436   0.562436   0.562436   0.562436   0.562436   0.562436   0.562436   0.562436","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"It only has one nonnegligible spherical harmonic coefficient. Can you spot it?","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"V = PA*F\nU4 = threshold!(P\\V, 3*eps())","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"5×9 Array{Float64,2}:\n 0.0      0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0\n 0.0      0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0\n 0.0      0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0\n 0.0      0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0\n 1.18164  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"That nonnegligible coefficient should be approximately √(2π/(4+1/2)), since the convention in this library is to orthonormalize.","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"nrm2 = norm(U4)","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"1.1816359006036774","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"Note that the integrals of both functions P_4(zcdot y) and P_4(zcdot x) and their L^2(mathbbS^2) norms are the same because of rotational invariance. The integral of either is perhaps not interesting as it is mathematically zero, but the norms of either should be approximately the same.","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"nrm1 ≈ nrm2","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"true","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"","category":"page"},{"location":"generated/sphere/#","page":"Spherical harmonic addition theorem","title":"Spherical harmonic addition theorem","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"EditURL = \"https://github.com/JuliaApproximation/FastTransforms.jl/blob/master/examples/spinweighted.jl\"","category":"page"},{"location":"generated/spinweighted/#Spin-weighted-spherical-harmonics-1","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"","category":"section"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"This example plays with analysis of:","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"f(r) = e^rm i kcdot r","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"for some kinmathbbR^3 and where rinmathbbS^2, using spin-0 spherical harmonics.","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"It applies ð, the spin-raising operator, both on the spin-0 coefficients as well as the original function, followed by a spin-1 analysis to compare coefficients.","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"For the storage pattern of the arrays, please consult the documentation.","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"using FastTransforms, LinearAlgebra","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"The colatitudinal grid (mod pi):","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"N = 10\nθ = (0.5:N-0.5)/N","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"0.05:0.1:0.95","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"The longitudinal grid (mod pi):","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"M = 2*N-1\nφ = (0:M-1)*2/M","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"0.0:0.10526315789473684:1.894736842105263","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"Our choice of k and angular parametrization of r:","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"k = [2/7, 3/7, 6/7]\nr = (θ,φ) -> [sinpi(θ)*cospi(φ), sinpi(θ)*sinpi(φ), cospi(θ)]","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"#1 (generic function with 1 method)","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"On the tensor product grid, our function samples are:","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"F = [exp(im*(k⋅r(θ,φ))) for θ in θ, φ in φ]","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"10×19 Array{Complex{Float64},2}:\n 0.628413+0.77788im   0.613246+0.789892im   0.603399+0.79744im    0.600106+0.79992im    0.603786+0.797146im   0.613972+0.789328im   0.629387+0.777092im   0.64815+0.761513im   0.668065+0.744103im   0.686931+0.726723im  0.702801+0.711386im    0.71416+0.699982im   0.720001+0.693973im    0.71983+0.694151im  0.713662+0.700491im   0.702017+0.71216im    0.685934+0.727664im  0.666955+0.745098im   0.647044+0.762452im\n 0.626742+0.779227im  0.582025+0.813171im   0.552374+0.833596im   0.542362+0.840145im    0.55355+0.832816im   0.584193+0.811615im   0.629571+0.776943im   0.68294+0.730474im   0.736952+0.675945im   0.785185+0.619262im  0.823211+0.567736im   0.848825+0.528674im   0.861428+0.507879im   0.861065+0.508495im   0.84773+0.530428im   0.821392+0.570364im   0.782715+0.62238im   0.734019+0.679129im   0.679858+0.733344im\n 0.690857+0.722991im  0.625071+0.780568im   0.580335+0.814378im   0.565059+0.82505im    0.582122+0.813101im   0.628309+0.777964im   0.694941+0.719066im  0.769832+0.638246im   0.840471+0.541857im   0.897514+0.440985im  0.936972+0.349406im   0.959893+0.280368im   0.969821+0.243819im   0.969549+0.244899im  0.958985+0.283457im   0.935221+0.354065im   0.894765+0.446538im  0.836798+0.547511im    0.76563+0.643282im\n 0.799876+0.600166im  0.729022+0.68449im    0.678871+0.734257im   0.661444+0.749994im   0.680901+0.732375im   0.732596+0.680663im   0.804139+0.594441im  0.878702+0.477371im   0.940401+0.340068im    0.97989+0.199537im  0.997175+0.0751106im  0.999864-0.0165003im  0.997938-0.0641824im  0.998027-0.062782im  0.999923-0.0124432im  0.996684+0.0813636im  0.978303+0.207181im  0.937478+0.348046im   0.874727+0.484617im\n 0.914598+0.404364im  0.858511+0.512795im   0.815749+0.578405im   0.800419+0.599441im    0.81752+0.5759im     0.861473+0.507803im   0.917769+0.397116im  0.967817+0.251653im   0.996186+0.0872572im   0.99722-0.07452im   0.977203-0.212305im   0.950621-0.310353im    0.93288-0.360187im   0.933439-0.358735im  0.952008-0.306074im   0.978656-0.205506im   0.997827-0.065887im   0.99532+0.0966353im  0.965471+0.260509im\n 0.989052+0.147569im  0.963701+0.266985im   0.939852+0.341582im   0.930644+0.365927im   0.940896+0.338696im   0.965234+0.261387im   0.990188+0.13974im   0.999905-0.0137846im  0.983699-0.179822im    0.94183-0.33609im    0.88602-0.463647im   0.834409-0.551146im   0.804097-0.594498im   0.805021-0.593247im  0.836879-0.547388im   0.889222-0.457475im   0.944703-0.327927im  0.985349-0.170549im   0.999989-0.00462386im\n  0.99096-0.134156im  0.999703-0.0243628im  0.998928+0.0462861im  0.997566+0.0697274im  0.999053+0.0435207im  0.999562-0.0295972im  0.989978-0.141225im  0.960887-0.276941im   0.908431-0.418034im   0.837893-0.545834im  0.762849-0.646576im   0.700449-0.713703im   0.665602-0.746307im   0.666649-0.745372im  0.703339-0.710855im    0.76689-0.641779im   0.842129-0.539276im   0.91195-0.410301im   0.963143-0.26899im\n 0.919472-0.393156im  0.950297-0.311346im   0.966254-0.257589im   0.970887-0.23954im    0.965686-0.259711im   0.948995-0.315292im    0.91723-0.398357im  0.867837-0.49685im    0.802371-0.596825im   0.727938-0.685643im  0.656033-0.754733im   0.599431-0.800426im   0.568692-0.82255im    0.569608-0.821916im  0.602006-0.798492im   0.659781-0.751458im   0.732172-0.68112im   0.806377-0.591401im   0.871077-0.491147im\n  0.80566-0.592379im  0.837633-0.546233im   0.856754-0.515725im   0.862863-0.505438im   0.856026-0.516933im   0.836173-0.548466im     0.8035-0.595305im  0.759389-0.650637im   0.707251-0.706962im   0.652712-0.757606im  0.602883-0.79783im    0.564968-0.825113im   0.544739-0.838606im   0.545338-0.838216im  0.566673-0.823943im   0.605429-0.795899im   0.655721-0.755004im  0.710305-0.703894im   0.762122-0.647434im\n 0.695346-0.718675im   0.70912-0.705088im   0.717813-0.696236im   0.720677-0.693271im   0.717475-0.696585im   0.708471-0.70574im    0.694445-0.719545im  0.676692-0.736266im   0.656981-0.753907im   0.637428-0.77051im   0.620269-0.784389im   0.607563-0.794272im   0.600886-0.799335im   0.601083-0.799186im  0.608129-0.793839im   0.621132-0.783706im   0.638483-0.769636im  0.658105-0.752927im    0.67776-0.735284im","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"We precompute a spin-0 spherical harmonic–Fourier plan:","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"P = plan_spinsph2fourier(F, 0)","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"FastTransforms Spin-weighted spherical harmonic--Fourier plan for 10×19-element array of Complex{Float64}","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"And an FFTW Fourier analysis plan on mathbbS^2:","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"PA = plan_spinsph_analysis(F, 0)","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"FastTransforms plan for FFTW Fourier analysis on the sphere (spin-weighted) for 10×19-element array of Complex{Float64}","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"Its spin-0 spherical harmonic coefficients are:","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"U⁰ = P\\(PA*F)","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"10×19 Array{Complex{Float64},2}:\n      2.98294-3.00733e-17im     -0.560381+0.373587im        0.560381+0.373587im        0.0307268-0.0737442im       0.0307268+0.0737442im      0.00123905+0.0063329im     -0.00123905+0.0063329im    -0.000278656-0.000280997im  -0.000278656+0.000280997im    1.91763e-5+3.91877e-6im    -1.91763e-5+3.91877e-6im    -7.51512e-7+3.05775e-7im    -7.51512e-7-3.05775e-7im     1.62607e-8-2.39542e-8im    -1.62607e-8-2.39542e-8im   -7.57577e-12+9.06989e-10im  -7.60426e-12-9.06983e-10im  -1.32856e-11-2.14392e-11im   1.44574e-11-2.09393e-11im\n -1.12703e-16+1.585im           -0.147488-0.221233im       -0.147488+0.221233im        0.0242802+0.0101168im      -0.0242802+0.0101168im       -0.001828+0.000357651im     -0.001828-0.000357651im    7.31346e-5-7.25251e-5im    -7.31346e-5-7.25251e-5im    -9.36425e-7+4.58234e-6im    -9.36425e-7-4.58234e-6im    -6.79393e-8-1.66977e-7im     6.79393e-8-1.66977e-7im     4.99533e-9+3.39094e-9im     4.99533e-9-3.39094e-9im   -1.78808e-10-1.49393e-12im   1.78807e-10-1.49873e-12im   3.97536e-12-2.4707e-12im    3.88748e-12+2.67669e-12im\n    -0.296042+1.70744e-16im     0.0419095-0.0279397im     -0.0419095-0.0279397im     -0.00179667+0.00431201im    -0.00179667-0.00431201im    -5.92556e-5-0.000302862im    5.92556e-5-0.000302862im    1.12623e-5+1.13569e-5im     1.12623e-5-1.13569e-5im    -6.70874e-7-1.37097e-7im     6.70874e-7-1.37097e-7im     2.31726e-8-9.42846e-9im     2.31726e-8+9.42846e-9im   -4.48157e-10+6.60198e-10im   4.48157e-10+6.60199e-10im   1.83261e-13-2.21049e-11im   1.86692e-13+2.21043e-11im   2.77118e-13+4.85414e-13im  -3.40632e-13+4.58325e-13im\n  5.68489e-17-0.0243812im      0.00315419+0.00473128im    0.00315419-0.00473128im   -0.000498246-0.000207603im   0.000498246-0.000207603im    3.42215e-5-6.6955e-6im      3.42215e-5+6.6955e-6im     -1.23971e-6+1.22938e-6im     1.23971e-6+1.22938e-6im     1.44141e-8-7.05344e-8im     1.44141e-8+7.05344e-8im    9.54963e-10+2.34704e-9im   -9.54963e-10+2.34704e-9im   -6.22737e-11-4.22729e-11im  -6.22737e-11+4.22728e-11im   2.09763e-12+1.71068e-14im  -2.09748e-12+1.79912e-14im  -5.56483e-13+3.38938e-13im    -5.396e-13-3.78591e-13im\n -0.000199834-9.8473e-17im   -0.000327232+0.000218154im  0.000327232+0.000218154im    1.67027e-5-4.00864e-5im     1.67027e-5+4.00864e-5im      5.5389e-7+2.83099e-6im     -5.5389e-7+2.83099e-6im    -1.01124e-7-1.01974e-7im    -1.01124e-7+1.01974e-7im     5.69484e-9+1.16377e-9im    -5.69484e-9+1.16377e-9im   -1.69612e-10+6.90117e-11im  -1.69612e-10-6.90117e-11im   2.98197e-12-4.39287e-12im  -2.98199e-12-4.39288e-12im  -3.49046e-14+4.21981e-12im  -3.57042e-14-4.21968e-12im  -4.59041e-14-8.03412e-14im   5.63706e-14-7.58562e-14im\n -8.63946e-17-0.000282488im    -7.0029e-6-1.05044e-5im    -7.0029e-6+1.05044e-5im     2.24809e-6+9.36704e-7im    -2.24809e-6+9.36704e-7im    -1.76539e-7+3.45402e-8im    -1.76539e-7-3.45402e-8im     6.55393e-9-6.49931e-9im    -6.55393e-9-6.49931e-9im    -7.1368e-11+3.49235e-10im   -7.1368e-11-3.49235e-10im  -4.99716e-12-1.22817e-11im   4.99717e-12-1.22817e-11im   1.69023e-11+1.14737e-11im   1.69023e-11-1.14737e-11im  -5.44918e-13-4.43261e-15im    5.4485e-13-4.70135e-15im   1.57981e-13-9.50594e-14im   1.52381e-13+1.08142e-13im\n   3.58969e-5+2.63577e-17im    -4.7402e-7+3.16014e-7im     4.7402e-7+3.16014e-7im    -3.23608e-8+7.76658e-8im    -3.23608e-8-7.76658e-8im     -1.6111e-9-8.2345e-9im       1.6111e-9-8.2345e-9im     2.28327e-10+2.30246e-10im   2.28327e-10-2.30246e-10im  -1.02557e-11-2.09579e-12im   1.02557e-11-2.09577e-12im   4.54949e-11-1.8511e-11im    4.54949e-11+1.85109e-11im  -5.65264e-13+8.32689e-13im   5.65262e-13+8.32674e-13im   9.40205e-15-1.14115e-12im    9.6568e-15+1.14112e-12im   8.76061e-15+1.53668e-14im  -1.07636e-14+1.4523e-14im\n  8.48008e-17+2.64492e-6im    -5.98533e-8-8.978e-8im     -5.98533e-8+8.978e-8im      -2.2753e-10-9.48042e-11im    2.2753e-10-9.48042e-11im   2.65455e-10-5.19369e-11im   2.65455e-10+5.19368e-11im  -1.37076e-11+1.35933e-11im   1.37075e-11+1.35933e-11im   3.35969e-11-1.64405e-10im   3.35969e-11+1.64405e-10im   1.96454e-12+4.82831e-12im  -1.96455e-12+4.82831e-12im  -8.01171e-12-5.43855e-12im  -8.01172e-12+5.43852e-12im    2.1536e-13+1.71679e-15im  -2.15343e-13+1.8516e-15im   -7.69638e-14+4.59648e-14im  -7.40019e-14-5.28691e-14im\n  -1.25204e-7-1.39244e-16im    6.65757e-9-4.43838e-9im   -6.65757e-9-4.43838e-9im   -1.43603e-11+3.44646e-11im  -1.43603e-11-3.44646e-11im   5.78501e-14+2.95753e-13im  -5.78729e-14+2.95748e-13im  -3.63314e-11-3.66368e-11im  -3.63314e-11+3.66367e-11im   7.38143e-13+1.5084e-13im   -7.38139e-13+1.50855e-13im   -7.2416e-12+2.94645e-12im   -7.2416e-12-2.94644e-12im   4.07018e-14-5.99541e-14im  -4.06894e-14-5.99553e-14im  -1.50688e-15+1.81794e-13im  -1.53155e-15-1.818e-13im      -6.168e-16-1.07929e-15im   7.92209e-16-1.03318e-15im\n -1.45432e-16-3.0609e-9im     4.29751e-10+6.44627e-10im  4.29751e-10-6.44627e-10im  -5.01384e-12-2.08911e-12im   5.01382e-12-2.08911e-12im  -3.61552e-10+7.07385e-11im  -3.61552e-10-7.07385e-11im   2.83376e-12-2.81014e-12im  -2.83375e-12-2.81015e-12im  -4.57901e-11+2.24071e-10im    -4.579e-11-2.24071e-10im   -4.0624e-13-9.98411e-13im   4.06235e-13-9.98416e-13im   1.09292e-11+7.41899e-12im   1.09292e-11-7.41902e-12im  -4.45693e-14-3.64169e-16im   4.45461e-14-3.93604e-16im   1.05365e-13-6.28734e-14im   1.01281e-13+7.23985e-14im","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"We can check its L^2(mathbbS^2) norm against an exact result:","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"norm(U⁰) ≈ sqrt(4π)","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"true","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"Spin can be incremented by applying ð, either on the spin-0 coefficients:","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"U¹c = zero(U⁰)\nfor n in 1:N-1\n    U¹c[n, 1] = sqrt(n*(n+1))*U⁰[n+1, 1]\nend\nfor m in 1:M÷2\n    for n in 0:N-1\n        U¹c[n+1, 2m] = -sqrt((n+m)*(n+m+1))*U⁰[n+1, 2m]\n        U¹c[n+1, 2m+1] = sqrt((n+m)*(n+m+1))*U⁰[n+1, 2m+1]\n    end\nend","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"or on the original function through analysis with spin-1 spherical harmonics:","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"F = [-(k[1]*(im*cospi(θ)*cospi(φ) + sinpi(φ)) + k[2]*(im*cospi(θ)*sinpi(φ)-cospi(φ)) - im*k[3]*sinpi(θ))*exp(im*(k⋅r(θ,φ))) for θ in θ, φ in φ]","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"10×19 Array{Complex{Float64},2}:\n   0.384531+0.240303im     0.405167+0.0811656im   0.376168-0.08059im    0.296802-0.228644im      0.17173-0.345547im    0.0121942-0.415058im     -0.164084-0.425345im    -0.334877-0.37218im      -0.47719-0.260862im    -0.571781-0.105926im  -0.607006+0.0715576im   -0.58067+0.248234im      -0.499453+0.402825im     -0.376425+0.519276im   -0.227802+0.588046im  -0.0700889+0.605739im   0.0817378+0.573795im    0.214909+0.497059im   0.318781+0.382786im\n    0.16375+0.41829im      0.162116+0.268361im    0.128477+0.110061im   0.056034-0.0418675im  -0.0588234-0.167146im    -0.211042-0.242529im     -0.383203-0.247832im    -0.546769-0.173942im    -0.669506-0.0288607im   -0.726395+0.162453im  -0.708448+0.365492im   -0.624684+0.547246im      -0.496849+0.685091im     -0.350631+0.769743im   -0.208037+0.802572im  -0.0835191+0.79034im     0.016198+0.740573im   0.0899356+0.659195im    0.13893+0.55045im\n 0.00394925+0.589002im   -0.0517508+0.441892im   -0.117739+0.283703im  -0.202276+0.132736im    -0.313608+0.0132761im   -0.450683-0.0475101im    -0.596088-0.0271995im   -0.717144+0.0808626im   -0.777618+0.259594im    -0.754769+0.470906im  -0.650847+0.67007im    -0.491452+0.823236im      -0.313141+0.917212im     -0.149502+0.957306im  -0.0230169+0.957535im   0.0563716+0.930505im   0.0891711+0.881918im    0.083394+0.810775im  0.0511118+0.713512im\n  -0.037706+0.764342im    -0.167663+0.63523im    -0.287398+0.487323im  -0.400578+0.346904im    -0.514827+0.244114im     -0.62967+0.207393im     -0.727882+0.254883im    -0.777945+0.383583im    -0.749353+0.563975im    -0.631836+0.748617im  -0.444017+0.892859im   -0.224888+0.974245im     -0.0160482+0.997806im      0.151723+0.986424im    0.261377+0.965157im    0.306018+0.948535im    0.286044+0.935214im    0.209798+0.910832im  0.0944472+0.857391im\n  0.0677134+0.90671im     -0.132933+0.832114im    -0.31272+0.722356im  -0.463011+0.610267im    -0.584223+0.531084im     -0.67363+0.512373im     -0.717075+0.564833im    -0.692616+0.674959im    -0.585463+0.805978im    -0.402896+0.912201im  -0.175697+0.960918im   0.0558086+0.947262im       0.258917+0.892857im      0.415705+0.832204im    0.518079+0.796763im    0.559103+0.802847im    0.530434+0.845158im    0.428907+0.898149im   0.265719+0.927327im\n   0.292353+0.944771im    0.0581069+0.961031im   -0.162367+0.923101im  -0.343726+0.861107im    -0.474077+0.809852im    -0.546787+0.794409im     -0.553921+0.82068im      -0.48849+0.87246im     -0.353637+0.917742im    -0.169005+0.924095im  0.0340849+0.875449im    0.226308+0.779766im       0.391603+0.66433im       0.527207+0.564551im    0.633493+0.513im       0.702424+0.529934im    0.714639+0.614543im    0.649544+0.740756im   0.502126+0.864782im\n   0.544556+0.82786im      0.335621+0.941682im     0.11692+0.992061im  -0.074329+0.994789im    -0.214433+0.975768im    -0.291963+0.955971im     -0.303796+0.942141im    -0.254076+0.925583im    -0.155653+0.88869im    -0.0290943+0.815954im    0.10377+0.703491im    0.228799+0.562131im       0.344287+0.414327im      0.457269+0.288908im    0.572819+0.215991im    0.682616+0.220188im    0.761104+0.310327im    0.774782+0.470071im   0.701202+0.658896im\n   0.711777+0.57455im      0.575876+0.753741im    0.402359+0.877629im   0.227778+0.943189im    0.0807159+0.961489im   -0.0227441+0.946886im     -0.078234+0.908848im   -0.0903981+0.849391im   -0.0697694+0.765587im   -0.0288206+0.65453im   0.0229208+0.517715im   0.0830404+0.363193im       0.157068+0.205921im      0.254332+0.067373im    0.379593-0.026087im    0.524118-0.0484074im   0.662039+0.0163403im    0.75688+0.163406im   0.777104+0.364037im\n   0.726602+0.264733im     0.673634+0.460754im    0.564658+0.62254im     0.42451+0.734172im     0.277783+0.792276im     0.142935+0.801596im     0.0303916+0.769731im   -0.0562551+0.703542im    -0.117442+0.608011im    -0.154422+0.487008im  -0.166521+0.34507im    -0.149734+0.189474im     -0.0974708+0.0321493im  -0.00385489-0.109276im    0.131046-0.212499im    0.296212-0.254862im    0.468111-0.220723im    0.615102-0.109082im   0.707182+0.0630756im\n   0.597178-0.0185423im    0.601301+0.161421im    0.546217+0.32944im    0.442188+0.46657im      0.304261+0.559965im     0.149097+0.603283im   -0.00741158+0.595734im    -0.151367+0.540622im    -0.271099+0.44408im     -0.356905+0.314404im  -0.400841+0.161998im   -0.397025-0.000359286im   -0.342634-0.157415im     -0.239438-0.292068im  -0.0953011-0.38711im    0.0751723-0.428079im    0.251638-0.406595im    0.410936-0.323077im    0.53139-0.187637im","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"We change plans with spin-1 now and reanalyze:","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"P = plan_spinsph2fourier(F, 1)\nPA = plan_spinsph_analysis(F, 1)\nU¹s = P\\(PA*F)","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"10×19 Array{Complex{Float64},2}:\n  2.71492e-17+2.24152im          0.792499-0.528332im        0.792499+0.528332im       -0.0752649+0.180636im       0.0752649+0.180636im     -0.00429218-0.0219378im     -0.00429218+0.0219378im      0.00124619+0.00125666im    -0.00124619+0.00125666im   -0.000105033-2.1464e-5im    -0.000105033+2.1464e-5im      4.87035e-6-1.98165e-6im    -4.87035e-6-1.98165e-6im    -1.21684e-7+1.79257e-7im    -1.21684e-7-1.79257e-7im    6.45559e-11-7.69602e-9im   -6.42651e-11-7.6961e-9im     1.84917e-10+2.67755e-10im   1.69277e-10-2.73299e-10im\n    -0.725151+6.43674e-18im      0.361271+0.541907im       -0.361271+0.541907im       -0.0841092-0.0350455im     -0.0841092+0.0350455im     0.00817504-0.00159947im    -0.00817504-0.00159947im   -0.000400574+0.000397236im  -0.000400574-0.000397236im    6.06873e-6-2.9697e-5im     -6.06873e-6-2.9697e-5im      5.08411e-7+1.24954e-6im     5.08411e-7-1.24954e-6im    -4.23861e-8-2.87724e-8im     4.23861e-8-2.87724e-8im     1.69612e-9+1.41282e-11im    1.69628e-9-1.41119e-11im  -5.16352e-11+1.39218e-11im   4.62638e-11+9.16743e-12im\n -6.43508e-17-0.0844589im       -0.145179+0.096786im       -0.145179-0.096786im       0.00803495-0.0192839im    -0.00803495-0.0192839im    0.000324556+0.00165884im    0.000324556-0.00165884im    -7.29881e-5-7.36014e-5im     7.29881e-5-7.36014e-5im     5.02037e-6+1.02593e-6im     5.02037e-6-1.02593e-6im     -1.9664e-7+8.00072e-8im      1.9664e-7+8.00072e-8im     4.25378e-9-6.26388e-9im     4.25378e-9+6.26388e-9im    6.53265e-12+2.1811e-10im   -6.52147e-12+2.18144e-10im   1.49453e-11+4.85414e-11im   1.32262e-11-5.01096e-11im\n -0.000893686+8.20906e-19im     -0.014106-0.0211589im       0.014106-0.0211589im      0.00272901+0.00113709im    0.00272901-0.00113709im   -0.00022178+4.33918e-5im     0.00022178+4.33918e-5im     9.27716e-6-9.19981e-6im     9.27716e-6+9.19981e-6im    -1.22275e-7+5.98394e-7im     1.22275e-7+5.98394e-7im    -9.06826e-9-2.22464e-8im    -9.06826e-9+2.22464e-8im    6.14926e-10+3.8178e-10im   -6.14926e-10+3.81779e-10im  -2.02946e-11+8.95683e-11im  -2.03114e-11-8.95764e-11im  -7.74597e-13-2.47298e-12im   9.78821e-13-2.19174e-12im\n    4.153e-17-0.00154725im     0.00179232-0.00119488im    0.00179232+0.00119488im   -0.000108246+0.00025979im   0.000108246+0.00025979im   -4.14499e-6-2.11852e-5im    -4.14499e-6+2.11852e-5im     8.58374e-7+8.65614e-7im    -8.58374e-7+8.65614e-7im    -5.40698e-8-1.11423e-8im    -5.40698e-8+1.11423e-8im     1.63049e-9-7.15813e-10im   -1.63049e-9-7.15813e-10im       2.6e-10+2.34806e-10im       2.6e-10-2.34805e-10im  -9.52906e-12-1.46894e-12im   9.53119e-12-1.47348e-12im   2.69188e-11+3.34655e-11im   2.46363e-11-3.42182e-11im\n  0.000232639-3.22079e-17im    4.53837e-5+6.80755e-5im   -4.53837e-5+6.80755e-5im    -1.68233e-5-7.00961e-6im   -1.68233e-5+7.00961e-6im    1.49733e-6-2.92965e-7im    -1.49733e-6-2.92965e-7im    -6.18845e-8+6.17602e-8im    -6.18845e-8-6.17602e-8im    4.71847e-10-3.03855e-9im   -4.71847e-10-3.03855e-9im     1.02475e-9-3.12161e-10im    1.02475e-9+3.12161e-10im   -2.3285e-11+2.79721e-11im   2.32849e-11+2.79721e-11im    5.5136e-12-2.47804e-11im   5.51952e-12+2.47829e-11im   2.05747e-13+6.50662e-13im  -2.63468e-13+5.82304e-13im\n  9.05841e-18+1.97929e-5im     3.54721e-6-2.36505e-6im    3.54721e-6+2.36505e-6im     2.74198e-7-6.5817e-7im    -2.74198e-7-6.5817e-7im     1.49997e-8+7.82205e-8im     1.49997e-8-7.82205e-8im    -2.72196e-9-2.73494e-9im     2.72196e-9-2.73494e-9im    4.22222e-10-1.58584e-9im    4.22222e-10+1.58584e-9im     1.4028e-11+4.2318e-11im   -1.40281e-11+4.2318e-11im   -7.00664e-11-6.32065e-11im  -7.00664e-11+6.32064e-11im   1.81319e-12+2.78523e-13im  -1.81361e-12+2.79417e-13im   1.64851e-11+2.52489e-11im   1.50292e-11-2.5936e-11im\n   -1.0618e-6-1.53414e-16im    5.06265e-7+7.59331e-7im   -5.06265e-7+7.59331e-7im     2.28542e-9+1.27481e-9im    2.28542e-9-1.27481e-9im   -1.53825e-9+3.35011e-10im    1.53825e-9+3.35011e-10im   -2.24932e-9-2.42853e-9im    -2.24932e-9+2.42853e-9im    1.43487e-10+3.57671e-11im  -1.43487e-10+3.5767e-11im   -4.84249e-10+1.47683e-10im  -4.84249e-10-1.47683e-10im   9.17837e-12-1.10319e-11im   -9.1783e-12-1.10319e-11im  -2.61497e-12+1.18851e-11im  -2.61824e-12-1.18864e-11im  -8.21338e-14-2.58936e-13im   1.05909e-13-2.32279e-13im\n -1.30907e-17-2.92736e-8im    -6.36569e-8+4.17996e-8im   -6.36569e-8-4.17996e-8im    6.18282e-10-1.39021e-9im  -6.18282e-10-1.39021e-9im  -4.16445e-10+7.77363e-11im  -4.16445e-10-7.77363e-11im   8.66308e-12-8.20833e-12im  -8.66307e-12-8.20834e-12im  -6.71953e-11+2.52391e-10im  -6.71953e-11-2.52391e-10im  -1.00987e-12-3.04633e-12im   1.00985e-12-3.04632e-12im   1.11584e-11+1.00647e-11im   1.11584e-11-1.00647e-11im  -1.30592e-13-2.00309e-14im   1.30626e-13-2.0137e-14im    9.94268e-12+1.41047e-11im   9.07739e-12-1.44631e-11im\n   -1.3507e-9+1.52959e-16im  -3.62349e-10-4.74615e-10im  3.62349e-10-4.74615e-10im    1.35757e-9-2.98609e-9im    1.35757e-9+2.98609e-9im  -2.68037e-12-1.17672e-11im   2.68035e-12-1.17672e-11im    3.06502e-9+3.30916e-9im     3.06502e-9-3.30916e-9im    -2.9668e-11-7.39518e-12im    2.9668e-11-7.39518e-12im   6.60325e-10-2.01412e-10im   6.60325e-10+2.01411e-10im  -1.89842e-12+2.28193e-12im   1.89842e-12+2.28192e-12im   3.56751e-12-1.6238e-11im    3.57201e-12+1.62398e-11im    1.6992e-14+5.36015e-14im  -2.19284e-14+4.80948e-14im","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"Finally, we check L^2(mathbbS^2) norms against another exact result:","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"norm(U¹c) ≈ norm(U¹s) ≈ sqrt(8π/3*(k⋅k))","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"true","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"","category":"page"},{"location":"generated/spinweighted/#","page":"Spin-weighted spherical harmonics","title":"Spin-weighted spherical harmonics","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"EditURL = \"https://github.com/JuliaApproximation/FastTransforms.jl/blob/master/examples/padua.jl\"","category":"page"},{"location":"generated/padua/#Padua-transform-1","page":"Padua transform","title":"Padua transform","text":"","category":"section"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"This demonstrates the Padua transform and inverse transform, explaining precisely the normalization and points","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"using FastTransforms","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"We define the Padua points and extract Cartesian components:","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"N = 15\npts = paduapoints(N)\nx = pts[:,1]\ny = pts[:,2];\nnothing #hide","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"We take the Padua transform of the function:","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"f = (x,y) -> exp(x + cos(y))\nf̌ = paduatransform(f.(x , y));\nnothing #hide","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"and use the coefficients to create an approximation to the function f:","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"f̃ = (x,y) -> begin\n    j = 1\n    ret = 0.0\n    for n in 0:N, k in 0:n\n        ret += f̌[j]*cos((n-k)*acos(x)) * cos(k*acos(y))\n        j += 1\n    end\n    ret\nend","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"#3 (generic function with 1 method)","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"At a particular point, is the function well-approximated?","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"f̃(0.1,0.2) ≈ f(0.1,0.2)","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"true","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"Does the inverse transform bring us back to the grid?","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"ipaduatransform(f̌) ≈ f̃.(x,y)","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"true","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"","category":"page"},{"location":"generated/padua/#","page":"Padua transform","title":"Padua transform","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"EditURL = \"https://github.com/JuliaApproximation/FastTransforms.jl/blob/master/examples/chebyshev.jl\"","category":"page"},{"location":"generated/chebyshev/#Chebyshev-transform-1","page":"Chebyshev transform","title":"Chebyshev transform","text":"","category":"section"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"This demonstrates the Chebyshev transform and inverse transform, explaining precisely the normalization and points","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"using FastTransforms\nn = 20","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"20","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"First kind points to first kind polynomials","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"p_1 = chebyshevpoints(Float64, n, Val(1))\nf = exp.(p_1)\nf̌ = chebyshevtransform(f, Val(1))\nf̃ = x -> [cos(k*acos(x)) for k=0:n-1]' * f̌\nf̃(0.1) ≈ exp(0.1)","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"true","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"First kind polynomials to first kind points","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"ichebyshevtransform(f̌, Val(1)) ≈ exp.(p_1)","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"true","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"Second kind points to first kind polynomials","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"p_2 = chebyshevpoints(Float64, n, Val(2))\nf = exp.(p_2)\nf̌ = chebyshevtransform(f, Val(2))\nf̃ = x -> [cos(k*acos(x)) for k=0:n-1]' * f̌\nf̃(0.1) ≈ exp(0.1)","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"true","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"First kind polynomials to second kind points","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"ichebyshevtransform(f̌, Val(2)) ≈ exp.(p_2)","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"true","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"First kind points to second kind polynomials","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"p_1 = chebyshevpoints(Float64, n, Val(1))\nf = exp.(p_1)\nf̌ = chebyshevutransform(f, Val(1))\nf̃ = x -> [sin((k+1)*acos(x))/sin(acos(x)) for k=0:n-1]' * f̌\nf̃(0.1) ≈ exp(0.1)","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"true","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"Second kind polynomials to first kind points","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"ichebyshevutransform(f̌, Val(1)) ≈ exp.(p_1)","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"true","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"Second kind points to second kind polynomials","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"p_2 = chebyshevpoints(Float64, n, Val(2))[2:n-1]\nf = exp.(p_2)\nf̌ = chebyshevutransform(f, Val(2))\nf̃ = x -> [sin((k+1)*acos(x))/sin(acos(x)) for k=0:n-3]' * f̌\nf̃(0.1) ≈ exp(0.1)","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"true","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"Second kind polynomials to second kind points","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"ichebyshevutransform(f̌, Val(2)) ≈ exp.(p_2)","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"true","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"","category":"page"},{"location":"generated/chebyshev/#","page":"Chebyshev transform","title":"Chebyshev transform","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"EditURL = \"https://github.com/JuliaApproximation/FastTransforms.jl/blob/master/examples/triangle.jl\"","category":"page"},{"location":"generated/triangle/#Calculus-on-the-reference-triangle-1","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"","category":"section"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"In this example, we sample a bivariate function:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"f(xy) = frac11+x^2+y^2","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"on the reference triangle with vertices (00), (01), and (10) and analyze it in a Proriol series. Then, we find Proriol series for each component of its gradient by term-by-term differentiation of our expansion, and we compare them with the true Proriol series by sampling an exact expression for the gradient.","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"We analyze f(xy) on an Ntimes M mapped tensor product grid defined by:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"beginaligned\nx  = (1+u)2quadrm andquad y = (1-u)(1+v)4quad rm where\nu_n  = cosleft(n+tfrac12)piNrightquadrm forquad 0le n  Nquadrm and\nv_m  = cosleft(m+tfrac12)piMrightquadrm forquad 0le m  M\nendaligned","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"we convert the function samples to mapped Chebyshev² coefficients using plan_tri_analysis; and finally, we transform the mapped Chebyshev² coefficients to Proriol coefficients using plan_tri2cheb.","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"For the storage pattern of the arrays, please consult the documentation.","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"using FastTransforms, LinearAlgebra","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"Our function f and the Cartesian components of its gradient:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"f = (x,y) -> 1/(1+x^2+y^2)\nfx = (x,y) -> -2x/(1+x^2+y^2)^2\nfy = (x,y) -> -2y/(1+x^2+y^2)^2","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"#5 (generic function with 1 method)","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"The polynomial degree:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"N = 10\nM = N","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"10","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"The parameters of the Proriol series:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"α, β, γ = 0, 0, 0","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"(0, 0, 0)","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"The u grid:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"u = [sinpi((N-2n-1)/(2N)) for n in 0:N-1]","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"10-element Array{Float64,1}:\n  0.9876883405951378\n  0.8910065241883678\n  0.7071067811865476\n  0.45399049973954675\n  0.15643446504023087\n -0.15643446504023087\n -0.45399049973954675\n -0.7071067811865476\n -0.8910065241883678\n -0.9876883405951378","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"And the v grid:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"v = [sinpi((M-2m-1)/(2M)) for m in 0:M-1]","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"10-element Array{Float64,1}:\n  0.9876883405951378\n  0.8910065241883678\n  0.7071067811865476\n  0.45399049973954675\n  0.15643446504023087\n -0.15643446504023087\n -0.45399049973954675\n -0.7071067811865476\n -0.8910065241883678\n -0.9876883405951378","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"Instead of using the utimes v grid, we use one with more accuracy near the origin. Defining x by:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"x = [sinpi((2N-2n-1)/(4N))^2 for n in 0:N-1]","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"10-element Array{Float64,1}:\n 0.9938441702975689\n 0.9455032620941839\n 0.8535533905932737\n 0.7269952498697735\n 0.5782172325201155\n 0.4217827674798846\n 0.2730047501302265\n 0.14644660940672624\n 0.05449673790581606\n 0.0061558297024311365","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"And w by:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"w = [sinpi((2M-2m-1)/(4M))^2 for m in 0:M-1]","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"10-element Array{Float64,1}:\n 0.9938441702975689\n 0.9455032620941839\n 0.8535533905932737\n 0.7269952498697735\n 0.5782172325201155\n 0.4217827674798846\n 0.2730047501302265\n 0.14644660940672624\n 0.05449673790581606\n 0.0061558297024311365","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"We see how the two grids are related:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"((1 .+ u)./2 ≈ x) * ((1 .- u).*(1 .+ v')/4 ≈ reverse(x).*w')","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"true","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"On the mapped tensor product grid, our function samples are:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"F = [f(x[n+1], x[N-n]*w[m+1]) for n in 0:N-1, m in 0:M-1]","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"10×10 Array{Float64,2}:\n 0.503078  0.503079  0.50308   0.503082  0.503084  0.503086  0.503087  0.503087  0.503087  0.503087\n 0.527173  0.527251  0.527387  0.527552  0.527713  0.527842  0.527928  0.527972  0.527987  0.52799\n 0.571515  0.572172  0.573336  0.57475   0.576129  0.577244  0.577984  0.578365  0.578497  0.578518\n 0.624166  0.6269    0.631783  0.63779   0.643732  0.6486    0.651858  0.653543  0.654132  0.654226\n 0.662229  0.669625  0.683086  0.700104  0.717456  0.732073  0.742063  0.7473    0.74914   0.749433\n 0.663072  0.677145  0.703491  0.738223  0.775386  0.80816   0.83138   0.843831  0.848253  0.848959\n 0.626344  0.646405  0.685125  0.738625  0.79921   0.855757  0.897728  0.920923  0.929281  0.930621\n 0.574363  0.597816  0.644232  0.710983  0.790497  0.868767  0.929587  0.964254  0.976934  0.978977\n 0.53023   0.554889  0.604493  0.677756  0.768133  0.860579  0.934929  0.978337  0.994407  0.997005\n 0.506165  0.531056  0.581514  0.656999  0.751727  0.850517  0.931398  0.97922   0.997037  0.999925","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"We precompute a Proriol–Chebyshev² plan:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"P = plan_tri2cheb(F, α, β, γ)","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"FastTransforms Proriol--Chebyshev² plan for 10×10-element array of Float64","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"And an FFTW Chebyshev² plan on the triangle:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"PA = plan_tri_analysis(F)","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"FastTransforms plan for FFTW Chebyshev analysis on the triangle for 10×10-element array of Float64","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"Its Proriol-(αβγ) coefficients are:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"U = P\\(PA*F)","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"10×10 Array{Float64,2}:\n  1.53694      -0.193325     -0.0251445     0.0109626    -0.000813085  -0.000299755   8.30468e-5   -1.61924e-6   -3.19816e-6    6.31957e-7\n -0.111616      0.0391775    -0.00636096   -0.000168171   0.000311286  -5.50448e-5   -2.98987e-6    2.98314e-6   -4.06883e-7   -5.78871e-8\n -0.0620411     0.00717665    0.00153129   -0.000551474   4.11469e-5    1.40636e-5   -4.21501e-6    2.00419e-7    1.36333e-7   -2.56682e-8\n  0.0111316    -0.00365775    0.000437389   4.52828e-5   -2.7266e-5     3.77416e-6    3.6054e-7    -2.19917e-7    3.13111e-10   1.29126e-8\n  0.00194131   -7.70783e-5   -0.000145998   3.68702e-5   -1.28779e-6   -1.24248e-6    2.77852e-7    4.79672e-8   -1.36897e-8   -3.73594e-9\n -0.000642627   0.000243882  -2.26656e-5   -5.85628e-6    2.24633e-6   -1.97917e-7   -1.29266e-7   -1.27255e-9    9.04471e-9    6.0323e-10\n -4.38754e-5   -1.7423e-5     1.19631e-5   -2.37625e-6   -1.47757e-7    1.49413e-7    5.42803e-8   -5.62503e-9   -4.66033e-9    1.01267e-10\n  2.80503e-5   -1.28088e-5    5.79531e-7    4.83844e-7    2.30075e-8   -6.94059e-8   -2.04348e-8    3.40901e-9    1.93914e-9   -1.14707e-10\n  1.13879e-6    2.27114e-6   -2.26963e-7   -1.25692e-7   -3.25964e-9    1.91384e-8    5.30824e-9   -9.96097e-10  -5.19607e-10   3.64107e-11\n -1.13155e-6    6.65015e-9    1.77115e-8    9.76935e-9    2.31971e-10  -1.49625e-9   -4.12577e-10   7.82931e-11   4.05113e-11  -2.88222e-12","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"Similarly, our function's gradient samples are:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"Fx = [fx(x[n+1], x[N-n]*w[m+1]) for n in 0:N-1, m in 0:M-1]","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"10×10 Array{Float64,2}:\n -0.503059    -0.503061    -0.503064    -0.503068    -0.503071    -0.503074   -0.503076   -0.503077   -0.503078   -0.503078\n -0.525533    -0.525687    -0.525959    -0.526289    -0.526609    -0.526868   -0.527039   -0.527126   -0.527157   -0.527162\n -0.55759     -0.558874    -0.56115     -0.563921    -0.56663     -0.568827   -0.570285   -0.571037   -0.571299   -0.57134\n -0.56645     -0.571423    -0.58036     -0.591449    -0.602521    -0.611668   -0.617827   -0.621027   -0.622146   -0.622324\n -0.507151    -0.518542    -0.539599    -0.566821    -0.595267    -0.619769   -0.636799   -0.645819   -0.649004   -0.649511\n -0.370886    -0.386796    -0.417481    -0.459721    -0.507171    -0.550951   -0.583067   -0.600662   -0.606973   -0.607984\n -0.214203    -0.228144    -0.256295    -0.297885    -0.348757    -0.399854   -0.440038   -0.463071   -0.471513   -0.472874\n -0.0966235   -0.104675    -0.121561    -0.148057    -0.183025    -0.221063   -0.253098   -0.272328   -0.279537   -0.280708\n -0.0306429   -0.0335592   -0.0398275   -0.0500666   -0.0643093   -0.0807201  -0.0952704  -0.104322   -0.107778   -0.108342\n -0.00315428  -0.00347214  -0.00416329  -0.00531429  -0.00695725  -0.008906   -0.0106804  -0.0118053  -0.0122388  -0.0123098","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"and:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"Fy = [fy(x[n+1], x[N-n]*w[m+1]) for n in 0:N-1, m in 0:M-1]","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"10×10 Array{Float64,2}:\n -0.00309674  -0.00294613  -0.00265964  -0.0022653  -0.00180173  -0.00131428  -0.000850692  -0.000456334  -0.000169814  -1.91818e-5\n -0.0301041   -0.0286482   -0.0258756   -0.0220528  -0.0175504   -0.0128085   -0.00829316   -0.0044494    -0.00165584   -0.000187041\n -0.0950785   -0.0906621   -0.0821785   -0.0703393  -0.0562133   -0.041164    -0.0267123    -0.014348     -0.00534173   -0.000603434\n -0.211406    -0.202889    -0.186023    -0.161468   -0.130828    -0.0968821   -0.0633397    -0.034153     -0.0127321    -0.00143861\n -0.367666    -0.357639    -0.335969    -0.300591   -0.251073    -0.190685    -0.126815     -0.0689903    -0.0257998    -0.00291656\n -0.505313    -0.501357    -0.488505    -0.458171   -0.40202     -0.31857     -0.218218     -0.12059      -0.0453463    -0.00513075\n -0.566899    -0.574426    -0.582548    -0.576688   -0.537001    -0.449109    -0.319905     -0.180588     -0.0684267    -0.00775164\n -0.559696    -0.576844    -0.604749    -0.627351   -0.61681     -0.543446    -0.402727     -0.232446     -0.0887896    -0.0100715\n -0.528372    -0.550513    -0.589802    -0.631498   -0.645145    -0.590695    -0.451254     -0.265063     -0.101904     -0.0115711\n -0.506117    -0.530019    -0.573719    -0.623748   -0.649471    -0.606462    -0.470749     -0.279118     -0.107682     -0.012234","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"For the partial derivative with respect to x, Olver et al. derive simple expressions for the representation of this component using a Proriol-(α+1βγ+1) series.","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"Gx = zeros(Float64, N, M)\nfor m = 0:M-2\n    for n = 0:N-2\n        cf1 = m == 0 ? sqrt((n+1)*(n+2m+α+β+γ+3)/(2m+β+γ+2)*(m+γ+1)*8) : sqrt((n+1)*(n+2m+α+β+γ+3)/(2m+β+γ+1)*(m+β+γ+1)/(2m+β+γ+2)*(m+γ+1)*8)\n        cf2 = sqrt((n+α+1)*(m+1)/(2m+β+γ+2)*(m+β+1)/(2m+β+γ+3)*(n+2m+β+γ+3)*8)\n        Gx[n+1, m+1] = cf1*U[n+2, m+1] + cf2*U[n+1, m+2]\n    end\nend\nPx = plan_tri2cheb(Fx, α+1, β, γ+1)\nUx = Px\\(PA*Fx)","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"10×10 Array{Float64,2}:\n -0.773299      0.0719368     0.0119032   -0.00401513    0.000198561   0.000113665  -2.54675e-5   -2.2655e-7     1.03149e-6   -1.7216e-7\n -0.223004      0.012725      0.00860848  -0.00187245   -6.32146e-5    8.83875e-5   -1.19358e-5   -1.69167e-6    7.76679e-7   -7.39561e-8\n  0.11832      -0.0184961    -0.00023125   0.000708495  -0.000135124  -8.87344e-7    5.69871e-6   -1.08572e-6   -5.1169e-8     5.59256e-8\n -0.00167067    0.00241808   -0.0010549    0.000134307   2.30923e-5   -1.11344e-5    1.16791e-6    2.73639e-7   -7.56093e-8   -9.88051e-9\n -0.00812992    0.00143141    9.50718e-5  -8.66652e-5    1.44746e-5    6.06362e-7   -6.84119e-7    3.76703e-8    4.17924e-8   -4.1622e-9\n  0.00134247   -0.000439988   9.61775e-5  -3.47089e-6   -3.49254e-6    1.08695e-6    1.48405e-7   -7.59334e-8   -1.44134e-8    5.66524e-9\n  0.000287448  -4.85646e-5   -1.64022e-5   7.96076e-6   -9.97598e-7   -5.74528e-7   -1.75861e-9    5.19823e-8    3.85683e-9   -3.81924e-9\n -0.000113291   3.61147e-5   -6.74826e-6  -6.76853e-7    4.89366e-7    2.2219e-7    -1.12907e-8   -2.20735e-8   -8.87121e-10   1.62442e-9\n -4.06399e-7   -2.15331e-6    5.99353e-7   1.29674e-7   -1.0952e-7    -4.69835e-8    3.09835e-9    4.78649e-9    1.51354e-10  -3.52555e-10\n  4.60231e-6   -2.60926e-8   -2.94735e-8  -6.31207e-9    5.41753e-9    2.3112e-9    -1.55957e-10  -2.36049e-10  -7.26455e-12   1.73881e-11","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"For the partial derivative with respect to y, the analogous formulae result in a Proriol-(αβ+1γ+1) series.","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"Gy = zeros(Float64, N, M)\nfor m = 0:M-2\n    for n = 0:N-2\n        Gy[n+1, m+1] = 4*sqrt((m+1)*(m+β+γ+2))*U[n+1, m+2]\n    end\nend\nPy = plan_tri2cheb(Fy, α, β+1, γ+1)\nUy = Py\\(PA*Fy)","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"10×10 Array{Float64,2}:\n -1.09361      -0.246364      0.151902     -0.014545     -0.00656717    0.00215252   -4.72964e-5   -0.000108877   2.12993e-5    1.42538e-6\n  0.221622     -0.0623246    -0.00233048    0.00556845   -0.00120596   -7.74683e-5    8.91372e-5   -1.4369e-5    -2.03658e-6    1.1703e-6\n  0.0405973     0.0150038    -0.00764115    0.00073608    0.000308021  -0.000109292   5.96196e-6    4.66644e-6   -1.12334e-6   -1.15876e-7\n -0.0206914     0.0042851     0.00062704   -0.000487772   8.28887e-5    9.42576e-6   -6.71487e-6    8.79882e-7    3.11934e-7   -5.32669e-8\n -0.000435917  -0.00142987    0.000511666  -2.29988e-5   -2.75726e-5    7.86154e-6   -1.19816e-7   -5.41219e-7   -2.58238e-8    3.83213e-8\n  0.00137946   -0.000223422  -8.2809e-5     4.01402e-5   -5.2886e-6    -1.3863e-6     4.58445e-7    2.06102e-7   -2.0874e-8    -1.70278e-8\n -9.81777e-5    0.000119744  -3.23136e-5   -2.56145e-6    2.16367e-6    2.69748e-7   -2.28145e-7   -6.49962e-8    1.34347e-8    6.00796e-9\n -7.30054e-5    6.86577e-6    1.00293e-5   -8.10204e-7   -5.44657e-7   -4.41007e-8    6.44172e-8    1.54358e-8   -4.05964e-9   -1.51096e-9\n  1.21727e-5   -7.40573e-6   -6.19814e-8    1.12925e-7    7.238e-8      4.8754e-9    -8.85313e-9   -2.01288e-9    5.68239e-10   2.00832e-10\n  1.11275e-6    8.48306e-9    1.79467e-9   -3.35205e-9   -2.13714e-9   -1.40622e-10   2.62395e-10   5.93038e-11  -1.68757e-11  -5.93006e-12","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"The 2-norm relative error in differentiating the Proriol series for f(xy) term-by-term and its sampled gradient is:","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"hypot(norm(Ux-Gx), norm(Uy-Gy))/hypot(norm(Ux), norm(Uy))","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"1.3657153423953995e-5","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"This error can be improved upon by increasing N and M.","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"","category":"page"},{"location":"generated/triangle/#","page":"Calculus on the reference triangle","title":"Calculus on the reference triangle","text":"This page was generated using Literate.jl.","category":"page"},{"location":"#FastTransforms.jl-Documentation-1","page":"Home","title":"FastTransforms.jl Documentation","text":"","category":"section"},{"location":"#Introduction-1","page":"Home","title":"Introduction","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.jl allows the user to conveniently work with orthogonal polynomials with degrees well into the millions.","category":"page"},{"location":"#","page":"Home","title":"Home","text":"This package provides a Julia wrapper for the C library of the same name. Additionally, all three types of nonuniform fast Fourier transforms available, as well as the Padua transform.","category":"page"},{"location":"#Fast-orthogonal-polynomial-transforms-1","page":"Home","title":"Fast orthogonal polynomial transforms","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"For this documentation, please see the documentation for FastTransforms. Most transforms have separate forward and inverse plans. In some instances, however, the inverse is in the sense of least-squares, and therefore only the forward transform is planned.","category":"page"},{"location":"#Nonuniform-fast-Fourier-transforms-1","page":"Home","title":"Nonuniform fast Fourier transforms","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"nufft1","category":"page"},{"location":"#FastTransforms.nufft1","page":"Home","title":"FastTransforms.nufft1","text":"Computes a nonuniform fast Fourier transform of type I:\n\nf_j = sum_k=0^N-1 c_k e^-2pirm i fracjN omega_kquadrm forquad 0 le j le N-1\n\n\n\n\n\nComputes a 2D nonuniform fast Fourier transform of type I-I:\n\nF_ij = sum_k=0^M-1sum_ell=0^N-1 C_kell e^-2pirm i (fraciM omega_k + fracjN pi_ell)quadrm forquad 0 le i le M-1quad 0 le j le N-1\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"nufft2","category":"page"},{"location":"#FastTransforms.nufft2","page":"Home","title":"FastTransforms.nufft2","text":"Computes a nonuniform fast Fourier transform of type II:\n\nf_j = sum_k=0^N-1 c_k e^-2pirm i x_j kquadrm forquad 0 le j le N-1\n\n\n\n\n\nComputes a 2D nonuniform fast Fourier transform of type II-II:\n\nF_ij = sum_k=0^M-1sum_ell=0^N-1 C_kell e^-2pirm i (x_i k + y_j ell)quadrm forquad 0 le i le M-1quad 0 le j le N-1\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"nufft3","category":"page"},{"location":"#FastTransforms.nufft3","page":"Home","title":"FastTransforms.nufft3","text":"Computes a nonuniform fast Fourier transform of type III:\n\nf_j = sum_k=0^N-1 c_k e^-2pirm i x_j omega_kquadrm forquad 0 le j le N-1\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"inufft1","category":"page"},{"location":"#FastTransforms.inufft1","page":"Home","title":"FastTransforms.inufft1","text":"Computes an inverse nonuniform fast Fourier transform of type I.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"inufft2","category":"page"},{"location":"#FastTransforms.inufft2","page":"Home","title":"FastTransforms.inufft2","text":"Computes an inverse nonuniform fast Fourier transform of type II.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"paduatransform","category":"page"},{"location":"#FastTransforms.paduatransform","page":"Home","title":"FastTransforms.paduatransform","text":"Padua Transform maps from interpolant values at the Padua points to the 2D Chebyshev coefficients.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"ipaduatransform","category":"page"},{"location":"#FastTransforms.ipaduatransform","page":"Home","title":"FastTransforms.ipaduatransform","text":"Inverse Padua Transform maps the 2D Chebyshev coefficients to the values of the interpolation polynomial at the Padua points.\n\n\n\n\n\n","category":"function"},{"location":"#Other-Exported-Methods-1","page":"Home","title":"Other Exported Methods","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"gaunt","category":"page"},{"location":"#FastTransforms.gaunt","page":"Home","title":"FastTransforms.gaunt","text":"Calculates the Gaunt coefficients, defined by:\n\na(mnmunuq) = frac2(n+nu-2q)+12 frac(n+nu-2q-m-mu)(n+nu-2q+m+mu) int_-1^+1 P_n^m(x) P_nu^mu(x) P_n+nu-2q^m+mu(x) rmdx\n\nor defined by:\n\nP_n^m(x) P_nu^mu(x) = sum_q=0^q_rm max a(mnmunuq) P_n+nu-2q^m+mu(x)\n\nThis is a Julia implementation of the stable recurrence described in:\n\nY.-l. Xu, Fast evaluation of Gaunt coefficients: recursive approach, J. Comp. Appl. Math., 85:53–65, 1997.\n\n\n\n\n\nCalculates the Gaunt coefficients in 64-bit floating-point arithmetic.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"paduapoints","category":"page"},{"location":"#FastTransforms.paduapoints","page":"Home","title":"FastTransforms.paduapoints","text":"Returns coordinates of the (n+1)(n+2)2 Padua points.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"sphevaluate","category":"page"},{"location":"#FastTransforms.sphevaluate","page":"Home","title":"FastTransforms.sphevaluate","text":"Pointwise evaluation of real orthonormal spherical harmonic:\n\nY_ell^m(thetavarphi) = (-1)^msqrt(ell+frac12)frac(ell-m)(ell+m) P_ell^m(costheta) sqrtfrac2-delta_m02pi leftbeginarrayccc cos mvarphi  rm for  m ge 0 sin(-mvarphi)  rm for  m  0endarrayright\n\n\n\n\n\n","category":"function"},{"location":"#Internal-Methods-1","page":"Home","title":"Internal Methods","text":"","category":"section"},{"location":"#Miscellaneous-Special-Functions-1","page":"Home","title":"Miscellaneous Special Functions","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.half","category":"page"},{"location":"#FastTransforms.half","page":"Home","title":"FastTransforms.half","text":"Compute a typed 0.5.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.two","category":"page"},{"location":"#FastTransforms.two","page":"Home","title":"FastTransforms.two","text":"Compute a typed 2.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.δ","category":"page"},{"location":"#FastTransforms.δ","page":"Home","title":"FastTransforms.δ","text":"The Kronecker delta function:\n\ndelta_kj = leftbeginarrayccc 1  rm for  k = j 0  rm for  k ne jendarrayright\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.Λ","category":"page"},{"location":"#FastTransforms.Λ","page":"Home","title":"FastTransforms.Λ","text":"The Lambda function Lambda(z) = fracGamma(z+frac12)Gamma(z+1) for the ratio of gamma functions.\n\n\n\n\n\nFor 64-bit floating-point arithmetic, the Lambda function uses the asymptotic series for tau in Appendix B of\n\nI. Bogaert and B. Michiels and J. Fostier, 𝒪(1) computation of Legendre polynomials and Gauss–Legendre nodes and weights for parallel computing, SIAM J. Sci. Comput., 34:C83–C101, 2012.\n\n\n\n\n\nThe Lambda function Lambda(zλ₁λ₂) = fracGamma(z+lambda_1)Γ(z+lambda_2) for the ratio of gamma functions.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.lambertw","category":"page"},{"location":"#FastTransforms.lambertw","page":"Home","title":"FastTransforms.lambertw","text":"The principal branch of the Lambert-W function, defined by x = W_0(x) e^W_0(x), computed using Halley's method for x in -e^-1infty).\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.pochhammer","category":"page"},{"location":"#FastTransforms.pochhammer","page":"Home","title":"FastTransforms.pochhammer","text":"Pochhammer symbol (x)_n = fracGamma(x+n)Gamma(x) for the rising factorial.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.stirlingseries","category":"page"},{"location":"#FastTransforms.stirlingseries","page":"Home","title":"FastTransforms.stirlingseries","text":"Stirling's asymptotic series for Gamma(z).\n\n\n\n\n\n","category":"function"},{"location":"#Modified-Chebyshev-Moment-Based-Quadrature-1","page":"Home","title":"Modified Chebyshev Moment-Based Quadrature","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.clenshawcurtisnodes","category":"page"},{"location":"#FastTransforms.clenshawcurtisnodes","page":"Home","title":"FastTransforms.clenshawcurtisnodes","text":"Compute nodes of the Clenshaw—Curtis quadrature rule.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.clenshawcurtisweights","category":"page"},{"location":"#FastTransforms.clenshawcurtisweights","page":"Home","title":"FastTransforms.clenshawcurtisweights","text":"Compute weights of the Clenshaw—Curtis quadrature rule with modified Chebyshev moments of the first kind mu.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.fejernodes1","category":"page"},{"location":"#FastTransforms.fejernodes1","page":"Home","title":"FastTransforms.fejernodes1","text":"Compute nodes of Fejer's first quadrature rule.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.fejerweights1","category":"page"},{"location":"#FastTransforms.fejerweights1","page":"Home","title":"FastTransforms.fejerweights1","text":"Compute weights of Fejer's first quadrature rule with modified Chebyshev moments of the first kind mu.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.fejernodes2","category":"page"},{"location":"#FastTransforms.fejernodes2","page":"Home","title":"FastTransforms.fejernodes2","text":"Compute nodes of Fejer's second quadrature rule.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.fejerweights2","category":"page"},{"location":"#FastTransforms.fejerweights2","page":"Home","title":"FastTransforms.fejerweights2","text":"Compute weights of Fejer's second quadrature rule with modified Chebyshev moments of the second kind mu.\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.chebyshevmoments1","category":"page"},{"location":"#FastTransforms.chebyshevmoments1","page":"Home","title":"FastTransforms.chebyshevmoments1","text":"Modified Chebyshev moments of the first kind:\n\n    int_-1^+1 T_n(x) rmdx\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.chebyshevjacobimoments1","category":"page"},{"location":"#FastTransforms.chebyshevjacobimoments1","page":"Home","title":"FastTransforms.chebyshevjacobimoments1","text":"Modified Chebyshev moments of the first kind with respect to the Jacobi weight:\n\n    int_-1^+1 T_n(x) (1-x)^alpha(1+x)^betarmdx\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.chebyshevlogmoments1","category":"page"},{"location":"#FastTransforms.chebyshevlogmoments1","page":"Home","title":"FastTransforms.chebyshevlogmoments1","text":"Modified Chebyshev moments of the first kind with respect to the logarithmic weight:\n\n    int_-1^+1 T_n(x) logleft(frac1-x2right)rmdx\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.chebyshevmoments2","category":"page"},{"location":"#FastTransforms.chebyshevmoments2","page":"Home","title":"FastTransforms.chebyshevmoments2","text":"Modified Chebyshev moments of the second kind:\n\n    int_-1^+1 U_n(x) rmdx\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.chebyshevjacobimoments2","category":"page"},{"location":"#FastTransforms.chebyshevjacobimoments2","page":"Home","title":"FastTransforms.chebyshevjacobimoments2","text":"Modified Chebyshev moments of the second kind with respect to the Jacobi weight:\n\n    int_-1^+1 U_n(x) (1-x)^alpha(1+x)^betarmdx\n\n\n\n\n\n","category":"function"},{"location":"#","page":"Home","title":"Home","text":"FastTransforms.chebyshevlogmoments2","category":"page"},{"location":"#FastTransforms.chebyshevlogmoments2","page":"Home","title":"FastTransforms.chebyshevlogmoments2","text":"Modified Chebyshev moments of the second kind with respect to the logarithmic weight:\n\n    int_-1^+1 U_n(x) logleft(frac1-x2right)rmdx\n\n\n\n\n\n","category":"function"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"EditURL = \"https://github.com/JuliaApproximation/FastTransforms.jl/blob/master/examples/nonlocaldiffusion.jl\"","category":"page"},{"location":"generated/nonlocaldiffusion/#Nonlocal-diffusion-on-\\mathbb{S}2-1","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"","category":"section"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"This example calculates the spectrum of the nonlocal diffusion operator:","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"mathcalL_delta u = int_mathbbS^2 rho_delta(mathbfx-mathbfy)leftu(mathbfx) - u(mathbfy)right mathrmdOmega(mathbfy)","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"defined in Eq. (2) of","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"R. M. Slevinsky, H. Montanelli, and Q. Du, A spectral method for nonlocal diffusion operators on the sphere, J. Comp. Phys., 372:893–911, 2018.","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"In the above, 0delta2, -1alpha1, and the kernel:","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"rho_delta(mathbfx-mathbfy) = frac4(1+alpha)pi delta^2+2alpha fracchi_0delta(mathbfx-mathbfy)mathbfx-mathbfy^2-2alpha","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"where chi_I(cdot) is the indicator function on the set I.","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"This nonlocal operator is diagonalized by spherical harmonics:","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"mathcalL_delta Y_ell^m(mathbfx) = lambda_ell(alpha delta) Y_ell^m(mathbfx)","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"and its eigenfunctions are given by the generalized Funk–Hecke formula:","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"lambda_ell(alpha delta) = frac(1+alpha) 2^2+alphadelta^2+2alphaint_1-delta^22^1 leftP_ell(t)-1right (1-t)^alpha-1 mathrmd t","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"In the paper, the authors use Clenshaw–Curtis quadrature and asymptotic evaluation of Legendre polynomials to achieve mathcalO(n^2log n) complexity for the evaluation of the first n eigenvalues. With a change of basis, this complexity can be reduced to mathcalO(nlog n).","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"First, we represent:","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"P_n(t) - 1 = sum_j=0^n-1 leftP_j+1(t) - P_j(t)right = -sum_j=0^n-1 (1-t) P_j^(10)(t)","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"Then, we represent P_j^(10)(t) with Jacobi polynomials P_i^(alpha0)(t) and we integrate using DLMF 18.9.16:","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"int_x^1 P_i^(alpha0)(t)(1-t)^alphamathrmdt = left beginarraycc frac(1-x)^alpha+1alpha+1  mathrmfori=0 frac12i(1-x)^alpha+1(1+x)P_i-1^(alpha+11)(x)  mathrmfori0endarrayright","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"The code below implements this algorithm, making use of the Jacobi–Jacobi transform plan_jac2jac. For numerical stability, the conversion from Jacobi polynomials P_j^(10)(t) to P_i^(alpha0)(t) is divided into conversion from P_j^(10)(t) to P_k^(00)(t), before conversion from P_k^(00)(t) to P_i^(alpha0)(t).","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"using FastTransforms, LinearAlgebra\n\nfunction oprec!(n::Integer, v::AbstractVector, alpha::Real, delta2::Real)\n    if n > 0\n        v[1] = 1\n    end\n    if n > 1\n        v[2] = (4*alpha+8-(alpha+4)*delta2)/4\n    end\n    for i = 1:n-2\n        v[i+2] = (((2*i+alpha+2)*(2*i+alpha+4)+alpha*(alpha+2))/(2*(i+1)*(2*i+alpha+2))*(2*i+alpha+3)/(i+alpha+3) - delta2/4*(2*i+alpha+3)/(i+1)*(2*i+alpha+4)/(i+alpha+3))*v[i+1] - (i+alpha+1)/(i+alpha+3)*(2*i+alpha+4)/(2*i+alpha+2)*v[i]\n    end\n    return v\nend\n\nfunction evaluate_lambda(n::Integer, alpha::T, delta::T) where T\n    delta2 = delta*delta\n    scl = (1+alpha)*(2-delta2/2)\n\n    lambda = Vector{T}(undef, n)\n\n    if n > 0\n        lambda[1] = 0\n    end\n    if n > 1\n        lambda[2] = -2\n    end\n\n    oprec!(n-2, view(lambda, 3:n), alpha, delta2)\n\n    for i = 2:n-1\n        lambda[i+1] *= -scl/(i-1)\n    end\n\n    p = plan_jac2jac(T, n-1, zero(T), zero(T), alpha, zero(T))\n\n    lambda[2:end] .= p'lambda[2:end]\n\n    for i = 2:n-1\n        lambda[i+1] = ((2i-1)*lambda[i+1] + (i-1)*lambda[i])/i\n    end\n\n    for i = 2:n-1\n        lambda[i+1] += lambda[i]\n    end\n\n    return lambda\nend","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"evaluate_lambda (generic function with 1 method)","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"The spectrum in Float64:","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"lambda = evaluate_lambda(10, -0.5, 1.0)","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"10-element Array{Float64,1}:\n   0.0\n  -2.0\n  -5.5\n  -9.75\n -14.09375\n -18.203125\n -22.08984375\n -25.935546875\n -29.8870849609375\n -33.95416259765625","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"The spectrum in BigFloat:","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"lambdabf = evaluate_lambda(10, parse(BigFloat, \"-0.5\"), parse(BigFloat, \"1.0\"))","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"10-element Array{BigFloat,1}:\n   0.0\n  -2.0\n  -5.5\n  -9.75\n -14.09375\n -18.203125\n -22.08984375\n -25.935546875\n -29.8870849609375\n -33.95416259765625","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"The infty-norm relative error:","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"norm(lambda-lambdabf, Inf)/norm(lambda, Inf)","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"0.0","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"","category":"page"},{"location":"generated/nonlocaldiffusion/#","page":"Nonlocal diffusion on mathbbS^2","title":"Nonlocal diffusion on mathbbS^2","text":"This page was generated using Literate.jl.","category":"page"}]
}
